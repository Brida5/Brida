<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Connexion privée</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
</head>
<body>
  <h2>Connexion par e-mail</h2>
  <input type="email" id="email" placeholder="Adresse e-mail">
  <input type="password" id="password" placeholder="Mot de passe">
  <button onclick="loginWithEmail()">Se connecter</button>
  <hr>

  <h2>Connexion par téléphone</h2>
  <input type="text" id="phone" placeholder="+33612345678">
  <div id="recaptcha-container"></div>
  <button onclick="sendSMS()">Recevoir un code</button>
  <br>
  <input type="text" id="code" placeholder="Code reçu par SMS">
  <button onclick="verifyCode()">Valider le code</button>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBPmdqX1YXG9c3SQGrh2Z-iJDq5c24xU6I",
      authDomain: "brida-4e4c6.firebaseapp.com",
      projectId: "brida-4e4c6",
      storageBucket: "brida-4e4c6.firebasestorage.app",
      messagingSenderId: "642160541367",
      appId: "1:642160541367:web:5db3f4f67dcb8b36175732",
      measurementId: "G-M2ZSX7SH6F"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    function loginWithEmail() {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;

      auth.signInWithEmailAndPassword(email, password)
        .then(() => alert("Connexion réussie !"))
        .catch(error => alert("Erreur : " + error.message));
    }

    window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {
      'size': 'normal',
      'callback': function(response) {
        // Recaptcha validé
      }
    });

    let confirmationResult;

    function sendSMS() {
      const phoneNumber = document.getElementById("phone").value;
      auth.signInWithPhoneNumber(phoneNumber, window.recaptchaVerifier)
        .then(result => {
          confirmationResult = result;
          alert("Code envoyé !");
        })
        .catch(error => alert("Erreur : " + error.message));
    }

    function verifyCode() {
      const code = document.getElementById("code").value;
      confirmationResult.confirm(code)
        .then(() => alert("Connexion réussie !"))
        .catch(error => alert("Erreur : " + error.message));
    }
  </script>
</body>
</html>
